{"version":3,"file":"pdfparser_cli.js","sources":["../../../src/cli/p2jcliarg.ts","../../../src/cli/p2jcli.ts"],"sourcesContent":[null,null],"names":["pkInfo","_PARSER_SIG","_PRO_TIMER","PDFParser","CLIArgParser","args","aliases","usageMsg","parsedArgv","constructor","Array","isArray","this","usage","alias","key","name","description","showHelp","helpMsg","value","Object","entries","console","log","argv","parseArgv","isNumber","x","test","setArg","val","Number","setKey","split","aliasKey","length","akey","avalue","push","forEach","obj","keys","o","i","undefined","prototype","String","arg","extractKey","match","warn","next","slice","yargs","process","ParserStream","StringifyStream","ONLY_SHOW_VERSION","ONLY_SHOW_HELP","VERBOSITY_LEVEL","HAS_INPUT_DIR_OR_FILE","PROCESS_RAW_TEXT_CONTENT","PROCESS_FIELDS_CONTENT","PROCESS_MERGE_BROKEN_TEXT_BLOCKS","PROCESS_WITH_STREAM","SINGLETON_PDF_PARSER","INPUT_DIR_OR_FILE","f","PDFProcessor","inputDir","inputFile","inputPath","outputDir","outputFile","outputPath","pdfParser","curCLI","path","normalize","join","generateMergedTextBlocksStream","Promise","resolve","reject","outputStream","createOutputStream","replace","getMergedTextBlocksStream","pipe","generateRawTextContentStream","getRawTextContentStream","generateFieldsTypesStream","getAllFieldsTypesStream","processAdditionalStreams","outputTasks","allSettled","onPrimarySuccess","addResultCount","then","retVal","catch","err","onPrimaryError","parseOnePDFStream","on","evtData","parserError","fs","createWriteStream","encoding","info","createReadStream","createParserStream","parseOnePDF","writeFile","JSON","stringify","loadPDF","validateParams","existsSync","promises","mkdir","recursive","inExtName","extname","toLowerCase","basename","fod","openSync","closeSync","unlinkSync","destroy","processFile","validateMsg","call","getOutputFile","PDFCLI","inputCount","successCount","failedCount","warningCount","statusMsgs","initialize","version","success","trim","error","e","Error","message","start","initResult","exit","time","errorMessage","hasError","inputStatus","statSync","isFile","processOneFile","dirname","isDirectory","processOneDirectory","addStatusMsg","complete","stdioFunc","nextTick","timeEnd","p2j","result","ret","status","finally","processFiles","files","allPromises","file","idx","readdir","toString","_iChars","pdfFiles","filter","indexOf","substring","oneMsg"],"mappings":"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"}